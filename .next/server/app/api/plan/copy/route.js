"use strict";(()=>{var e={};e.id=117,e.ids=[117],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4367:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>P,patchFetch:()=>g,requestAsyncStorage:()=>u,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>c});var n={};a.r(n),a.d(n,{POST:()=>l});var r=a(9303),i=a(8716),o=a(670),s=a(7070),d=a(71);async function l(e){let t=await e.json().catch(()=>null),a=t?.ownerProfileId,n=t?.classId,r=t?.roomId,i=t?.sourcePlanId;if(!a||!n||!r||!i)return s.NextResponse.json({error:"invalid body"},{status:400});let o=await d._.seatingPlan.findUnique({where:{id:i},include:{elements:!0}});if(!o)return s.NextResponse.json({error:"source not found"},{status:404});let l=await d._.seatingPlan.findUnique({where:{ownerProfileId_classId_roomId:{ownerProfileId:a,classId:n,roomId:r}}});l?await d._.seatingPlan.update({where:{id:l.id},data:{sourcePlanId:o.id}}):l=await d._.seatingPlan.create({data:{ownerProfileId:a,classId:n,roomId:r,sourcePlanId:o.id}}),await d._.$transaction([d._.seatingElement.deleteMany({where:{seatingPlanId:l.id}}),d._.seatingElement.createMany({data:o.elements.map(e=>({seatingPlanId:l.id,type:e.type,refId:e.refId,x:e.x,y:e.y,w:e.w,h:e.h,rotation:e.rotation,z:e.z,groupId:e.groupId,meta:e.meta??void 0}))})]);let p=await d._.seatingPlan.findUnique({where:{id:l.id},include:{elements:!0}});return s.NextResponse.json({ok:!0,plan:p})}let p=new r.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/plan/copy/route",pathname:"/api/plan/copy",filename:"route",bundlePath:"app/api/plan/copy/route"},resolvedPagePath:"/Users/jz/Platzhirsch/app/api/plan/copy/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:u,staticGenerationAsyncStorage:c,serverHooks:m}=p,P="/api/plan/copy/route";function g(){return(0,o.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:c})}},71:(e,t,a)=>{a.d(t,{_:()=>r});var n=a(3524);let r=globalThis.prisma??new n.PrismaClient({log:["error"]})}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),n=t.X(0,[948,59],()=>a(4367));module.exports=n})();